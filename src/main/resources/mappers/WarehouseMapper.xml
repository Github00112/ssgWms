<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssg.wsmt.inventory.mapper.WarehouseMapper">

    <insert id="createWarehouse" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO WAREHOUSE(TYPE, LOCATION, DELIVERY_CMP_ID)
        VALUES (#{TYPE}, #{LOCATION}, #{DELIVERY_CMP_ID})
    </insert>

    <insert id="saveWarehouseSection" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO WAREHOUSE_SECTION (WAREHOUSE_ID, NAME, TYPE)
        VALUES (#{WAREHOUSE_ID}, #{NAME}, #{TYPE})
    </insert>

<!--    <select id="readWarehouse" resultType="com.ssg.wsmt.inventory.domain.WarehouseVO">-->
<!--        SELECT-->
<!--            ID as id,-->
<!--            TYPE as type,-->
<!--            LOCATION as location,-->
<!--            DELIVERY_CMP_ID as deliveryId-->
<!--            FROM WAREHOUSE-->
<!--    </select>-->
    <select id="readWarehouse" resultType="com.ssg.wsmt.inventory.domain.WarehouseVO">
        SELECT
        ID as id,
        TYPE as type,
        LOCATION as location,
        DELIVERY_CMP_ID as deliveryId
        FROM WAREHOUSE
        <where>
            <if test="type != null and keyword != null">
                <choose>
                    <when test="type == 'type'">
                        TYPE LIKE CONCAT('%', #{keyword}, '%')
                    </when>
                    <when test="type == 'location'">
                        LOCATION LIKE CONCAT('%', #{keyword}, '%')
                    </when>
                    <!-- 다른 검색 조건 추가 -->
                </choose>
            </if>
        </where>
        ORDER BY ID
        LIMIT #{page}, #{size}
    </select>

    <select id="getTotalCount" resultType="int">
        SELECT COUNT(*)
        FROM WAREHOUSE
        <where>
            <if test="type != null and keyword != null">
                <choose>
                    <when test="type == 'type'">
                        TYPE LIKE CONCAT('%', #{keyword}, '%')
                    </when>
                    <when test="type == 'location'">
                        LOCATION LIKE CONCAT('%', #{keyword}, '%')
                    </when>
                    <!-- 다른 검색 조건 추가 -->
                </choose>
            </if>
        </where>
    </select>

    <update id="updateDeliveryCmpId">
        UPDATE WAREHOUSE SET DELIVERY_CMP_ID = #{delivery_id} WHERE ID = #{id}
    </update>

    <update id="updateWarehouse">
        UPDATE WAREHOUSE SET TYPE = {type}, LOCATION = {location}, DELIVERY_CMP_ID = {delivery_id} WHERE ID = {id}
    </update>

    <select id="findById" resultType="com.ssg.wsmt.inventory.domain.WarehouseVO">
        SELECT * FROM WAREHOUSE WHERE ID = #{id}
    </select>

    

    <insert id="createSection" parameterType="com.ssg.wsmt.inventory.domain.Warehouse">
        <!-- Add your SQL statement here for creating sections -->
        <!-- Example: -->
        <!-- INSERT INTO WAREHOUSE_SECTION (WAREHOUSE_ID, NAME) VALUES (#{id}, '냉동식품') -->
        <!-- Repeat for other sections -->
    </insert>

    <select id="readWarehouse" resultType="com.ssg.wsmt.inventory.domain.Warehouse">
        SELECT * FROM WAREHOUSE
    </select>

</mapper>